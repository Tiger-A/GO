package main

import (
	"bufio"
	"fmt"
	"os"
	"strings"
	"unicode"
)

type Text struct {
	Content string
}

func (t *Text) textModifier() {
	// Удаляем лишние пробелы
	t.Content = strings.ReplaceAll(t.Content, "  ", " ")
	for strings.Contains(t.Content, "  ") {
		t.Content = strings.ReplaceAll(t.Content, "  ", " ")
	}

	// Обрабатываем знак минус (-)
	runes := []rune(t.Content)
	result := []rune{}
	i := 0
	for i < len(runes) {
		if runes[i] == '-' {
			if i > 0 && i < len(runes)-1 {
				// Меняем местами символы слева и справа от минуса
				runes[i-1], runes[i+1] = runes[i+1], runes[i-1]
			}
			i++ // Пропускаем символ минус
		} else {
			result = append(result, runes[i])
		}
		i++
	}
	t.Content = string(result)

	// Заменяем знак плюс (+) на восклицательный знак (!)
	t.Content = strings.ReplaceAll(t.Content, "+", "!")

	// Считаем сумму цифр и удаляем их из текста
	sum := 0
	runeText := []rune(t.Content)
	result = []rune{}
	for _, r := range runeText {
		if unicode.IsDigit(r) {
			sum += int(r - '0')
		} else {
			result = append(result, r)
		}
	}
	t.Content = string(result)

	// Добавляем сумму цифр в конец строки, если она больше 0
	if sum > 0 {
		t.Content = fmt.Sprintf("%s %d", t.Content, sum)
	}

	// Выводим результат
	fmt.Println(t.Content)
}

func main() {
	text := &Text{}
	// Создаем новый сканер для чтения из стандартного ввода
	scanner := bufio.NewScanner(os.Stdin)

	// Просим пользователя ввести строку
	fmt.Println("Введите строку:")

	for scanner.Scan() {
		text.Content = scanner.Text()
		text.textModifier()
		fmt.Println("Введите строку:")
	}

	if err := scanner.Err(); err != nil {
		fmt.Fprintln(os.Stderr, "Ошибка чтения ввода:", err)
	}
}

// func (t *Text) textModifier() {

// // Заменяем все подряд идущие пробелы на один
// resultString = strings.ReplaceAll(resultString, "  ", " ")

// // Повторяем замену до тех пор, пока не останется только один пробел
// for strings.Contains(resultString, "  ") {
// resultString = strings.ReplaceAll(resultString, "  ", " ")
// // Возможно правильнее было бы встроить это в цикл ниже?

// 	fmt.Println(t.Content)
// }

// 2. Допустим это символы а, б, 5,   действия: для первого случая-  удалить найденную букву из строки, второго -добавить еще одну такую же букву,  посчитать все цифры в строке

// 1. Пользователь вводит текст одной строкой и нажимает “enter”.

// 2. В тексте могут присутствовать различные специальные символы, которые надо обрабатывать согласно условиям ниже:

// Если в тексте между словами присутствует несколько пробелов подряд, надо оставить только один из них. Для реализации этого подпункта можно пользоваться методами Replace() и ReplaceAll() из пакета strings.

// Если в тексте присутствует знак минус (-), это значит, что символ слева от этого знака надо поменять местами с символом,
// который стоит справа от этого знака. Обратите внимание, что символом может быть не только буква, но и цифра или любой другой знак/символ,
// в том числе символ пробела. После смены символов местами, знак минус (-) надо удалить из строки результата.

// Если в тексте присутствует знак плюс (+), вам необходимо заменить его на восклицательный знак (!).
// В тексте могут присутствовать цифры (от 0 до 9). Вам необходимо посчитать их сумму и удалить из текста. Сумму цифр вам нужно добавить в конец результирующей строки через пробел (пробел должен стоять перед суммой цифр). Если цифр в тексте не было - “0” (ноль) в конце строки выводить не нужно.

// Все манипуляции с текстом должны выполняться ровно в той последовательности, которая описана в пункте 2. То есть, сначала выполняется пункт A, затем пункт B, затем C и D. Это важно для получения корректного итогового результата.
// Решение задачи залей на go.dev/play
// (посмотри видео, как это сделать правильно → Видео)
// и отправь нам ссылку на почту info@kata.academy, тема письма: ТЗ Golang. Внутри письма должна быть только ссылка.
// Пример ввода:
// генрих1  играет+2   л-июбит0школу

// Пример вывода:

// генрих играет! илюбитшколу 3

// Пример ввода №2:

// Я ю-лбю-л голанг   всем сердцем+

// Пример вывода:

// Я люблю голанг всем сердцем!
// Каркас приложения по ссылке https://go.dev/play/p/9YLiLLS7t7Y
// Материалы для подготовки https://gobyexample.ru/

// 1. Давай напишем мою первую программу на GO. Обяьсняй мне все очень подробно. Давай примем ввод текста с клавиатуры и запишем в переменную userText
// 2. Допустим это символы а, б, 5,   действия: для первого случая-  удалить найденную букву из строки, второго -добавить еще одну такую же букву,  посчитать все цифры в строке

// 1. Пользователь вводит текст одной строкой и нажимает “enter”.

// 2. В тексте могут присутствовать различные специальные символы, которые надо обрабатывать согласно условиям ниже:

// Если в тексте между словами присутствует несколько пробелов подряд, надо оставить только один из них. Для реализации этого подпункта можно пользоваться методами Replace() и ReplaceAll() из пакета strings.
// Если в тексте присутствует знак минус (-), это значит, что символ слева от этого знака надо поменять местами с символом, который стоит справа от этого знака. Обратите внимание, что символом может быть не только буква, но и цифра или любой другой знак/символ, в том числе символ пробела. После смены символов местами, знак минус (-) надо удалить из строки результата.
// Если в тексте присутствует знак плюс (+), вам необходимо заменить его на восклицательный знак (!).
// В тексте могут присутствовать цифры (от 0 до 9). Вам необходимо посчитать их сумму и удалить из текста. Сумму цифр вам нужно добавить в конец результирующей строки через пробел (пробел должен стоять перед суммой цифр). Если цифр в тексте не было - “0” (ноль) в конце строки выводить не нужно.
// Все манипуляции с текстом должны выполняться ровно в той последовательности, которая описана в пункте 2. То есть, сначала выполняется пункт A, затем пункт B, затем C и D. Это важно для получения корректного итогового результата.
// Решение задачи залей на go.dev/play
// (посмотри видео, как это сделать правильно → Видео)
// и отправь нам ссылку на почту info@kata.academy, тема письма: ТЗ Golang. Внутри письма должна быть только ссылка.
// Пример ввода:
// генрих1  играет+2   л-июбит0школу

// Пример вывода:

// генрих играет! илюбитшколу 3

// Пример ввода №2:

// Я ю-лбю-л голанг   всем сердцем+

// Пример вывода:

// Я люблю голанг всем сердцем!
// Каркас приложения по ссылке https://go.dev/play/p/9YLiLLS7t7Y
// Материалы для подготовки https://gobyexample.ru/
